<template>
  <main>
    <!-- <div class="parent"> -->
      <div class="horizontalize">
        <div class="column_container">
          <div  id="concept" class="column column1">
            <!-- <section id="topback"> -->
              <div id="toplogo">
                <img class="logo_img" src="../static/Gypsyworks_logo_black.png"></img>
              </div>
              <div id="sns_container">
                <a href="https://instagram.com/fumiiiiii?igshid=YmMyMTA2M2Y="><img class="snsimg" src="../static/Instagram_logo.png"></img></a>
                <!-- <img class="snsimg" src="../static/Twitter_blue.png"></img> -->
              </div>
            <!-- </section> -->
          </div>
          <div  id="product" class="column column2">
            <img src="../static/someru.jpg"></img>
          </div>
          <div  id="company" class="column column3">
            <!-- <section>
                <div class="stage" @click="moveCat1">
                  <div class="note">„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„ÅÇ„Åü„Çä„Åæ„Åß„Çπ„É©„Ç§„Éâ„Åó„Åæ„Åô</div>
                  <BoxCat1 ref="cat1" />
                </div>
            </section> -->
          </div>
          <div class="column column4">
            <div class="products_container">
              <div v-for="product in products" :key= "product.name" class="product_bg">
                <img class="product_photo" :src="product.image_url">
                <div class="product_name"> <p>{{product.name}}<br>¬•{{product.members_price_including_tax}}</p></div>
                <!-- <h1 class="title_txt">„Éï„Ç©„É≥„Éà„Å¶„Åô„Å®font</h1> -->
                <div class="product_caption">
                   <p>{{product.name}}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    <!-- </div> -->
  </main>
</template>

<script>
import axios from 'axios'
import '../assets/scss/style.scss'
// gsap
import { gsap } from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";
// firebase to get products
import { initializeApp } from 'firebase/app'
import { getStorage, ref, getDownloadURL } from "firebase/storage"
import '../assets/scss/style.scss'
if (process.client) {
  gsap.registerPlugin(ScrollTrigger)
}

// import BoxCat1 from '../components/common/BoxCat1'



export default {
  name: 'App',
  // components: {
  //   BoxCat1
  // },
  data () {
    return {
      loginForm: {
        email: '',
        password: '',
      },
      users: [],
      accessToken: '',
      msg: 'change point',
      products: [],
    }
  },
  mutations: {
  },
  created() {
    console.log("get inside categories in created")
    const firebaseConfig = {
      storageBucket: 'gs://gypsyworks-5cf3e.appspot.com'
    }
      // Initialize Firebase
    const app = initializeApp(firebaseConfig)
    // Initialize Cloud Storage and get a reference to the service
    const storage = getStorage(app)
    // Create a storage reference from our storage service
    const myfileRef = ref(storage, 'my-file')
    // URLÁµåÁî±„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
    getDownloadURL(myfileRef)
      .then((url) => {
        console.log(url)
        fetch(url)
          .then(result => result.json())
            .then((output) => {
              for(const i in output.products) {
                this.products.push(output.products[i]);
              }
              // console.log(this.products);
            }).catch(err => console.error(err));
      })
      .catch((error) => {
        console.log(error)
      })
  },
  mounted() {
    this.gsapHorizon();
  },
  methods: {
    gsapHorizon () {
        console.log("mounted‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ‚àÜ")
      // window.addEventListener("load", function(){
        const horizontalize  = document.querySelector(".horizontalize");
        const columnContainer  = document.querySelector(".column_container");
        const columns = document.querySelectorAll(".column");
        const num   = columns.length;

        // Ê®™ÂπÖ„ÇíÊåáÂÆö
        gsap.set(columnContainer,  { width: num * 100 + "%" });
        gsap.set(columnContainer,  { x: (num-1) * -100 + "vw" });
        gsap.set(columns, { width: 100 / num + "%" }); // Ê®™„Çπ„ÇØÁî®„Å´Â§ß„Åç„Åè„Åó„ÅüË¶™Ë¶ÅÁ¥†„ÅåÔºì00%„Å™„Çâ„ÄÅÂ≠êË¶ÅÁ¥†Ôºë„Å§„Åå100%

        gsap.to(columns, {
          // xPercent: 100 * ( num - 1 ), // xÊñπÂêë„Å´ÁßªÂãï„Åï„Åõ„Çã
          x: () => (columnContainer.clientWidth - horizontalize.clientWidth),
          ease: "none", // <-- IMPORTANT!
          scrollTrigger: {
            trigger: horizontalize, // „Éà„É™„Ç¨„Éº
            start: "top top", // ÈñãÂßã‰ΩçÁΩÆ
            // end: "+=1000", // ÁµÇ‰∫Ü‰ΩçÁΩÆ
            end: () => `+=${columnContainer.clientWidth - horizontalize.clientWidth}`,
            pin: true, // „Éî„É≥Áïô„ÇÅ=„Çπ„ÇØ„É≠„Éº„É´‰∏≠ÊåáÂÆöË¶ÅÁ¥†„ÇíÂõ∫ÂÆö
            scrub: true, // „Çπ„ÇØ„É≠„Éº„É´Èáè„Å´Âøú„Åò„Å¶Âãï„Åã„Åô
            // scrub: 2, // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Åå„Çπ„ÇØ„É≠„Éº„É´„Å´ÂèçÂøú„Åô„Çã„Åæ„Åß„ÅÆÊôÇÈñì
            // snap: { // „Ç≠„É™„ÅÆËâØ„ÅÑ‰ΩçÁΩÆ„Å∏ÁßªÂãï„Åï„Åõ„Çã
            //   snapTo: 1 / ( num - 1 ),
            //   duration: 2,
            // },
            invalidateOnRefresh: true,
            // horizontal: true, // „Çπ„ÇØ„É≠„Éº„É´„ÅÆ„ÇÄ„Åç
            // preventOverlaps: true,
            onEnter: ()=> console.log("for debug column amount is...: " + num),
          }
        });

        // right picture clipping mask
        // gsap.fromTo('.right_img_container2', {
        //   // Èñ¢Êï∞„ÅßÊåáÂÆö„Åô„Çã„Åì„Å®„Åß„ÄÅ„É™„Çµ„Ç§„Ç∫„Å´„Çà„Å£„Å¶Ë¶ÅÁ¥†„ÅÆÂ§ß„Åç„Åï„ÅåÂ§â„Çè„Å£„Å¶„ÇÇËá™Âãï„Åß„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇíË®àÁÆó„ÅóÁõ¥„Åó„Å¶„Åè„Çå„Åæ„Åô„ÄÇ
        //   // x: () => -(listEl.clientWidth - listWrapperEl.clientWidth) https://liginc.co.jp/548232#JavaScript
        //   x: "0",
        //   y: "0",
        //   clipPath: "inset(0% 0% 100%)",
        //   // pin: true,
        // },
        // {
        //   x: '0',
        //   y: '0',
        //   clipPath: "inset(0% 0% 0%)",
        //   scrollTrigger: {
        //     trigger: '.main_container',
        //     // Á¨¨‰∏ÄÂºïÊï∞Ôºù„Éà„É™„Ç¨„ÉºË¶ÅÁ¥†„ÅÆÊåáÂÆö„Åó„Åü‰ΩçÁΩÆ„Å®Á¨¨‰∫åÂºïÊï∞=„Éñ„É©„Ç¶„Ç∂ÁîªÈù¢„ÅÆÊåáÂÆö„Åó„Åü‰ΩçÁΩÆ „Åå„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÅÆËµ∑ÁÇπ„ÄÅÁµÇÁÇπ„Å´„Å™„Çã
        //     start: 'center left',
        //     end: 'right right',
        //     // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Çí„Çπ„ÇØ„É≠„Éº„É´‰ΩçÁΩÆ„Å´„É™„É≥„ÇØ„Åï„Åõ„Çã
        //     scrub: true,
        //     markers: true, // „Éû„Éº„Ç´„ÉºË°®Á§∫
        //     preventOverlaps: true,
        //     // pin: true,
        //     containerAnimation: scrollHorizonal
        //   }
        // });
        // // vertical moving


        // 3
        // gsap.fromTo('.right_img_container3', {
        //   x: "0",
        //   y: "0",
        //   clipPath: "inset(0% 0% 100%)",
        //   containerAnimation: scrollHorizonal,
        // },
        // {
        //   x: '0',
        //   y: '0',
        //   clipPath: "inset(0% 0% 0%)",
        //   scrollTrigger: {
        //     trigger: '.sc_trigger2',
        //     start: 'top bottom',
        //     end: 'bottom bottom',
        //     scrub: true,
        //     markers: false, // „Éû„Éº„Ç´„ÉºË°®Á§∫
        //     containerAnimation: scrollHorizonal,
        //   }
        // });
      // });
    },
    scrollItemA() {
      // const browserH = String(window.innerHeight);
    },
    scrollItemB() {
    },
    moveCat1 (ev) {
      // „ÇØ„É™„ÉÉ„ÇØ„Åï„Çå„ÅüXÂ∫ßÊ®ô„Åæ„Åß„Çπ„É©„Ç§„Éâ„Åô„Çã
      this.$refs.cat1.moveTo(ev.offsetX, ev.offsetY)
    },
    getProducts () {
      axios.get('https://api.shop-pro.jp/v1/products', {
        headers: {
          'Authorization': `Bearer ${this.$store.state.token.access_toke}`
        }
      })
      .then((res) => {
        console.log(res.data)
      })
      .catch((error) => {
        console.error(error)
      })
    },
  }
}
</script>

<style scoped lang="scss">

  .horizontalize {
    overflow: hidden;
    position: relative;
    width: 100vw;
    height: 100vh;
    .column_container {
      // margin-left: -200vw;
      position: absolute;
      display: flex;
      flex-direction: row-reverse;

      width: 300vw;
      height: 100%;
      .column {
        height: 100%;
        background-color: rgb(10, 20, 30);
        position: relative;

        width: 100vw;
        #toplogo{
          position: absolute;
          width: 30vh;
          height: 30vh;
          // background-color: rgb(100, 250, 200);
          //css3„ÅÆ‰∏≠Â§ÆÊèÉ„Åà
          top: 50%;
          left: 50%;
          // margin-right: -50%;
          transform: translate(-50%, -50%);
          .logo_img{
            width: 100%;
            height: auto;
            object-fit: cover;
          }
        }
        #sns_container{
          position:absolute;
          display: flex;
          width: 30vh;
          height: 10vh;
          left: 5%;
          bottom:10%;
          //background-color: rgb(0, 0, 200);
          .snsimg{
            margin: 0px 10px;
            //background-color: rgb(200, 0, 200);
            width: 8vh;
            height: 8vh;
          }
        }
      }
      .column1 {
        background-color: red;
      }
      .column2 {
        background-color: purple;
        display: flex;
        align-items: center; // ‰∏ä‰∏ã‰∏≠Â§Æ„Å´
        justify-content: center; // Â∑¶Âè≥‰∏≠Â§Æ„Å´
        img {
          object-fit: contain;
          width: 100%;
          height: auto;
          max-width: 100%; // üñêspÂØæÁ≠ñ„Å´Â§ß‰∫ã!
        }
      }
      .column3 {
        background-color: blue;
        height: 500vh;
        display: flex;
        flex-direction: column;
      }
      .column4 {
        background-color: red;
      }
    }
  }


  .centerize_container{
    display: flex;
    background-color: rgb(50, 100, 150);

    .photo_bg{
      width: 18vw;
      height: 45vh;
      margin: 10px;
      background-color: rgb(100, 44,44);
      display: block;
      // justify-content: center;
      .photo_item{
        width: 16vw;
        height: 16vw;
        background-color: rgb(0, 44,44);
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
      }
      .photo_caption{
        width: 100%;
        height: 2vw;
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
        background-color: rgb(0, 100,44);
      }
      .stores_container{
        margin-left: auto;
        margin-right: auto;
        height: 44px;
        // Â≠êË¶ÅÁ¥†„ÅÆÂ§ß„Åç„Åï„Å´Âêà„Çè„Åõ„Å¶ÂπÖÂèØÂ§â
        width: fit-content;
      }

    }
  }

  @mixin triggerCSS {
    width: 300px;
    height: 255px;
    margin-top: 140px;
    background-color: rgb(0, 200, 199);
  }
  @mixin image_containerCSS {
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgb(210, 30, 100);
    overflow: hidden;
    min-width: 100%;
    max-height: 100%;
    object-fit: cover;
    object-position: top;
    position: absolute;
  }
  .main_container {
    height: 50%;
    width: 100vw;
    background-color: rgb(200, 200, 110);
    display: block;
    // position: -webkit-sticky; /* Safari„Å´ÂØæÂøú„Åô„Çã */
    // position: sticky;
  }
  .main_container_second {
    height: 50%;
    width: 100vw;
    background-color: rgb(255, 200, 110);
    display: flex;
    margin-top: 250vh;
  }
  .left_split{
    width: 50%;
    height: auto;
    background-color: rgb(100, 0, 100);
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    //position:-webkit-sticky; position:sticky; top:0;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
    //display: table-cell;
    .main_title{
      height: 10%;
    }

    .sc_trigger1{
      @include triggerCSS;
    }
    .sc_trigger2{
      @include triggerCSS;
    }
    .sc_trigger3{
      @include triggerCSS;
    }
    .sc_trigger4{
      @include triggerCSS;
    }
    .sc_trigger5{
      @include triggerCSS;
    }
  }
  .right_sprit{
    width: 50%;
    // height: 100%;
    background-color: rgb(200, 0, 100);
    position:relative;
    .right-sticky{
      top: 0;
      left: 0;
      width: 100%;
      height:100vh;
      background-color: rgb(210, 30, 100);
      overflow: hidden;
      min-width: 100%;

      position: -webkit-sticky; /* Safari„Å´ÂØæÂøú„Åô„Çã */
      position: sticky; /* Ë¶ÅÁ¥†„ÇíÂõ∫ÂÆö/Ëß£Èô§„Åô„Çã */
      //  position: sticky; „ÅØ„ÄÅË¶™Ë¶ÅÁ¥†„ÅÆheight„ÇíÂü∫Ê∫ñ„Å´Âõ∫ÂÆö„Åï„Çå„Çã‰ΩçÁΩÆ„ÅåÊ±∫„Åæ„Çä„Åæ„Åô„ÄÇ
      // ÔºàË¶™Ë¶ÅÁ¥†„ÅÆheight„ÇíË∂Ö„Åà„Åü„Çâ„ÄÅÂõ∫ÂÆö„ÅåËß£Èô§„Åï„Çå„ÇãÔºâ
      // „Åù„ÅÆ„Åü„ÇÅ„ÄÅË¶™Ë¶ÅÁ¥†„Å´height„ÇíÊåáÂÆö„Åó„Å™„ÅÑ„Å®„ÄÅ„Åù„ÇÇ„Åù„ÇÇÊúâÂäπ„Å´„Å™„Çä„Åæ„Åõ„Çì„ÄÇ
      .right_img_container{
        @include image_containerCSS;
      }
      .right_img_container2{
        @include image_containerCSS;
        // transform-origin: left top;
        // clip-path 100%„Åßimg„ÅåË¶ã„Åà„Å™„Åè„Å™„Çã„Éû„Çπ„ÇØ„ÅÆË®≠ÂÆö„ÄÇÈÅ©Áî®ÁØÑÂõ≤ÈñãÂßã‰ΩçÁΩÆ‰ª•‰∏ã„Åß100%, ÈÅ©Áî®ÁµÇÁÇπ‰ª•‰∏ä„Åß0%„Å´„Åô„Çã„Åì„Å®„Åß„Å†„Çì„Å†„ÇìË°®Á§∫„Åï„Åõ„Çã
        // Ë®àÁÆóÂºèÔºö1 - ((„Çπ„ÇØ„É≠„Éº„É´Èáè - „ÇØ„É™„ÉÉ„Éî„É≥„Ç∞„Éû„Çπ„ÇØËß£Èô§ÈÅ©Áî®ÈñãÂßã‰ΩçÁΩÆ„ÅÆÂ∫ßÊ®ô) / Ëß£Èô§ÈñãÂßã„Åã„ÇâÁµÇ‰∫Ü„Åæ„Åß„ÅÆ„Çπ„ÇØ„É≠„Éº„É´ÂπÖ) * 100%
        // clip-path: inset(0% 0% calc((1 - min((max(var(--scroll-Y), 0) - var(--clipStart-YIn1)) / var(--switch-Length), 1)) * 100%));
      }
      .right_img_container3{
        @include image_containerCSS;
      }
      .right_img_container4{
        @include image_containerCSS;
      }
      .right_img_container5{
        @include image_containerCSS;
      }
    }

  }
  // products
  .title_txt{
    font-family: 'Dymo';
    font-size: 20px;
    color: rgb(100, 150, 100);
  }

  .products_container{
    display: flex;
    // background-color: rgb(50, 100, 150);
    flex-wrap: wrap;
    margin-top: 50px;
    justify-content: space-around;
    .product_bg{
      width: 20vw;
      // height: 45vh;
      margin: 0px;
      // background-color: rgb(100, 44,44);
      display: block;
      // justify-content: center;
      .product_photo{
        width: 16vw;
        height: 16vw;
        position: relative;
        left: 2vw;
        object-fit: cover;
        // background-image: url(https://img21.shop-pro.jp/PA01480/113/product/170941223.jpg?cmsp_timestamp=20221015160054);
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
      }
      .product_name{
        width: 100%;
        height: auto;
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
        // background-color: rgb(100, 0,44);
        text-align: center;
        font-family: "Oradano-mincho-GSRR";
        font-size: 20px;
        font-feature-settings: "titl";
        // .p{
        //   font-family: "Oradano-mincho-GSRR";
        //   font-size: 300px;
        // }
      }
      .product_caption{
        width: 100%;
        height: auto;
        margin-top: 10px;
        margin-left: auto;
        margin-right: auto;
        // background-color: rgb(0, 220,44);
        text-align: center;
        font-size: small;
      }
      .stores_container{
        margin-left: auto;
        margin-right: auto;
        height: 44px;
        // Â≠êË¶ÅÁ¥†„ÅÆÂ§ß„Åç„Åï„Å´Âêà„Çè„Åõ„Å¶ÂπÖÂèØÂ§â
        width: fit-content;
      }

    }
  }

  .stage {
  position: relative;
  width: 100%;
  height: 350px;
  border: 1px solid #aaa;
  background-color: rgb(248, 248, 247);
  overflow: hidden;
  }
  .note {
  color: #888;
  text-align: center;
  position: absolute;
  width: 100%;
  user-select: none;
  }
</style>
